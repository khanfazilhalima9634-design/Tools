<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>GlobalLoanCalc — Loan & EMI Calculator</title>
  <meta name="description" content="Free online loan and EMI calculator with multi-currency and multi-language support. Calculate monthly payments, interest breakdowns and amortization schedules.">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://www.yourwebsite.com/global-loan-calculator.html">

  <!-- AdSense config (ONLY change values here) -->
  <script>
    // Replace these values with your AdSense IDs to enable ads.
    // Example client: 'ca-pub-1234567890123456'
    // Example slot: '1234567890'
    window.ADSENSE_CONFIG = {
      client: '', // e.g. 'ca-pub-XXXXXXXXXXXXXXX'
      slots: {
        top: '',          // leaderboard slot id
        sidebar_large: '',// 300x600 slot id
        sidebar_small: '' // 300x250 slot id
      }
    };
  </script>

  <!-- Load AdSense script dynamically only if configured -->
  <script>
    (function(){
      const cfg = window.ADSENSE_CONFIG || {};
      if (!cfg.client || !cfg.client.startsWith('ca-pub-')) return;
      const s = document.createElement('script');
      s.async = true;
      s.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=' + encodeURIComponent(cfg.client);
      s.crossOrigin = 'anonymous';
      document.head.appendChild(s);
    })();
  </script>

  <!-- Fonts + icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root{
      --bg: linear-gradient(180deg,#f8fbff 0,#eef6ff 100%);
      --card: #fff;
      --muted: #64748b;
      --accent: #4f46e5;
      --accent-2: #06b6d4;
      --radius: 12px;
      --shadow: 0 12px 30px rgba(16,24,40,0.06);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:#0f1724}
    .container{max-width:1100px;margin:0 auto;padding:20px}
    header{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:14px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(90deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800}
    nav ul{display:flex;gap:12px;list-style:none;margin:0;padding:0}
    nav a{color:#0f1724;text-decoration:none;font-weight:600}
    .ad-top{margin:12px 0;border-radius:12px;overflow:hidden;min-height:90px;background:#fff;border:1px dashed rgba(15,23,42,0.06);display:flex;align-items:center;justify-content:center}
    main{display:grid;grid-template-columns:1fr 340px;gap:20px;align-items:start}
    @media(max-width:980px){main{grid-template-columns:1fr}}
    .card{background:var(--card);padding:16px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .title{font-size:1.4rem;margin:0 0 8px 0}
    label{display:block;font-weight:700;margin-bottom:6px}
    input[type=text], input[type=number], select{width:100%;padding:10px;border-radius:8px;border:1px solid #eef2ff;background:#fbfdff;font-size:15px}
    .field-with-symbol{position:relative}
    .currency-symbol{position:absolute;left:12px;top:12px;color:var(--muted);font-weight:700}
    .slider{width:100%;margin-top:8px}
    .slider-value{text-align:right;color:var(--accent);font-weight:700;margin-top:6px}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .btn{padding:10px 14px;border-radius:8px;border:0;cursor:pointer;font-weight:700}
    .btn-primary{background:linear-gradient(90deg,var(--accent),#8b5cf6);color:#fff}
    .btn-ghost{background:transparent;border:1px solid rgba(15,23,42,0.06);color:var(--muted)}
    .results{margin-top:14px;display:none}
    .results.active{display:block}
    .grid-3{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px}
    .result-card{padding:12px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfdff);border-left:6px solid var(--accent)}
    .result-card .value{font-weight:800;color:var(--accent);font-size:1.15rem}
    .amort-wrap{max-height:360px;overflow:auto;margin-top:12px;border-radius:8px;border:1px solid #f1f5f9}
    table{width:100%;border-collapse:collapse;background:white}
    th,td{padding:10px;border-bottom:1px solid #f1f5f9;text-align:left;font-size:14px}
    th{background:linear-gradient(90deg,var(--accent),#8b5cf6);color:white;position:sticky;top:0}
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .ad-box{min-height:250px;border-radius:8px;border:1px dashed rgba(15,23,42,0.06);display:flex;align-items:center;justify-content:center;background:#fff;padding:12px}
    footer{margin-top:20px;text-align:center;color:var(--muted);font-size:13px}
    .small{font-size:13px;color:var(--muted)}
    .dropdown{position:absolute;top:100%;right:0;background:white;border-radius:8px;box-shadow:var(--shadow);padding:0.5rem 0;min-width:200px;max-height:260px;overflow:auto;display:none;z-index:10}
    .dropdown-item{padding:0.6rem 0.9rem;cursor:pointer;display:flex;align-items:center;gap:10px;color:#0f1724}
    .dropdown-item:hover{background:#f8f9fa}
    .selector-btn{background:rgba(255,255,255,0.12);border:none;color:white;padding:8px 10px;border-radius:8px;display:flex;align-items:center;gap:8px;cursor:pointer}
    .header-controls{display:flex;gap:10px;align-items:center}
    header .header-controls .selector-btn{background:transparent;color:#fff}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">GL</div>
        <div>
          <div style="font-weight:800">GlobalLoanCalc</div>
          <div class="small">Loan & EMI Tools</div>
        </div>
      </div>

      <div class="header-controls" aria-hidden>
        <!-- Language selector -->
        <div style="position:relative;">
          <button id="language-btn" class="selector-btn" aria-haspopup="listbox" aria-expanded="false">
            <i class="fas fa-language" aria-hidden></i> <span id="current-language">English</span> <i class="fas fa-chevron-down"></i>
          </button>
          <div id="language-dropdown" class="dropdown" role="listbox" aria-label="Choose language"></div>
        </div>

        <!-- Currency selector -->
        <div style="position:relative;">
          <button id="currency-btn" class="selector-btn" aria-haspopup="listbox" aria-expanded="false">
            <i class="fas fa-money-bill-wave" aria-hidden></i> <span id="current-currency">USD</span> <i class="fas fa-chevron-down"></i>
          </button>
          <div id="currency-dropdown" class="dropdown" role="listbox" aria-label="Choose currency"></div>
        </div>
      </div>
    </header>

    <!-- Top Ad placeholder -->
    <div id="ad-top" class="ad-top card"><div id="ad-top-inner">Ad Space — Leaderboard (configure in ADSENSE_CONFIG)</div></div>

    <main>
      <!-- main calculator -->
      <section class="card" id="main-card" aria-labelledby="hero-title">
        <h1 id="hero-title" class="title" data-translate="hero_title">Global Loan & EMI Calculator</h1>
        <p class="small" data-translate="hero_description">Plan your finances with our advanced loan calculator. Get accurate monthly payment estimates, interest breakdowns, and amortization schedules for personal, home, car, and education loans in any currency.</p>

        <div style="margin-top:12px;display:grid;gap:12px">
          <!-- Currency & language visible fallback for non-js environments -->
          <div style="display:flex;gap:8px;align-items:center">
            <label class="small">Currency</label>
            <div id="current-currency-display" class="small" style="margin-left:6px">USD</div>
          </div>

          <!-- Loan amount -->
          <div>
            <label for="loan-amount" data-translate="loan_amount">Loan Amount</label>
            <div class="field-with-symbol">
              <span id="loan-currency-symbol" class="currency-symbol">$</span>
              <input id="loan-amount" type="text" inputmode="numeric" placeholder="25000" value="25000" aria-label="Loan amount">
            </div>
            <input id="loan-amount-slider" class="slider" type="range" min="100" max="1000000" step="100" value="25000" aria-hidden="true">
            <div class="slider-value" id="loan-amount-value">$25,000.00</div>
          </div>

          <!-- rate + term -->
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
            <div>
              <label for="interest-rate" data-translate="interest_rate">Interest Rate (annual %)</label>
              <input id="interest-rate" type="number" step="0.01" value="7.5" aria-label="Interest rate">
              <input id="interest-rate-slider" class="slider" type="range" min="0" max="100" step="0.01" value="7.5" aria-hidden="true">
              <div class="slider-value" id="interest-rate-value">7.5%</div>
            </div>

            <div>
              <label for="loan-term" data-translate="loan_term">Loan Term (years)</label>
              <input id="loan-term" type="number" step="1" min="1" value="5" aria-label="Loan term">
              <input id="loan-term-slider" class="slider" type="range" min="1" max="50" step="1" value="5" aria-hidden="true">
              <div class="slider-value" id="loan-term-value">5 Years</div>
            </div>
          </div>

          <!-- loan type -->
          <div>
            <label for="loan-type" data-translate="loan_type">Loan Type</label>
            <select id="loan-type" aria-label="Loan type">
              <option value="personal" data-translate="personal_loan">Personal Loan</option>
              <option value="home" data-translate="home_loan">Home Loan</option>
              <option value="car" data-translate="car_loan">Car Loan</option>
              <option value="education" data-translate="education_loan">Education Loan</option>
              <option value="business" data-translate="business_loan">Business Loan</option>
            </select>
          </div>

          <!-- controls -->
          <div class="controls">
            <button id="calculate-btn" class="btn btn-primary"><i class="fas fa-calculator"></i> <span data-translate="calculate_emi">Calculate EMI</span></button>
            <button id="reset-btn" class="btn btn-ghost"><i class="fas fa-redo"></i> <span data-translate="reset">Reset</span></button>
            <button id="print-btn" class="btn btn-ghost"><i class="fas fa-print"></i> <span data-translate="print_results">Print</span></button>
          </div>

          <!-- results -->
          <div id="results-container" class="results" aria-live="polite">
            <h2 data-translate="results">Loan Calculation Results</h2>
            <div class="grid-3" style="margin-top:8px">
              <div class="result-card"><div class="small" data-translate="monthly_payment">Monthly Payment</div><div class="value emi-value" id="monthly-payment">$0.00</div></div>
              <div class="result-card"><div class="small" data-translate="total_interest">Total Interest</div><div class="value" id="total-interest">$0.00</div></div>
              <div class="result-card"><div class="small" data-translate="total_payment">Total Payment</div><div class="value" id="total-payment">$0.00</div></div>
            </div>

            <div style="margin-top:12px">
              <div class="small">Payoff Date</div>
              <div id="payoff-date" class="small">—</div>
            </div>

            <div class="amort-wrap" style="margin-top:12px">
              <table id="amortization-table" aria-label="Amortization schedule">
                <thead>
                  <tr>
                    <th data-translate="month">Month</th>
                    <th data-translate="payment">EMI</th>
                    <th data-translate="principal">Principal</th>
                    <th data-translate="interest">Interest</th>
                    <th data-translate="balance">Balance</th>
                  </tr>
                </thead>
                <tbody id="amortization-body"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- FAQ snippet (keeps SEO friendly content) -->
        <section style="margin-top:14px" class="card">
          <h3 data-translate="faq_title">Frequently Asked Questions</h3>
          <div style="margin-top:8px">
            <strong data-translate="faq1_question">What is an EMI?</strong>
            <p class="small" data-translate="faq1_answer">EMI stands for Equated Monthly Installment — the fixed monthly payment covering principal and interest.</p>
          </div>
        </section>
      </section>

      <!-- sidebar (ads + info) -->
      <aside class="sidebar">
        <div class="card">
          <div style="font-weight:800">Why GlobalLoanCalc?</div>
          <ul class="small" style="margin-top:8px">
            <li>Private, client-side calculations</li>
            <li>Multi-currency formatting</li>
            <li>SEO-friendly markup & structured data</li>
          </ul>
        </div>

        <!-- sidebar ad placeholders -->
        <div class="ad-box card" id="ad-slot-sidebar-large"><div id="ad-slot-sidebar-large-inner">Ad Space — 300×600 (configure ADSENSE_CONFIG)</div></div>
        <div class="ad-box card" id="ad-slot-sidebar-small"><div id="ad-slot-sidebar-small-inner">Ad Space — 300×250 (configure ADSENSE_CONFIG)</div></div>
      </aside>
    </main>

    <footer>
      <div class="small">© 2025 GlobalLoanCalc • Privacy-first • Built for performance</div>
    </footer>
  </div>

  <!-- ====== SCRIPT: UI logic, calculation, language & currency, ads ====== -->
  <script>
  // --- Data (currencies + languages + translations) ---
  const currencies = [
    { code: 'USD', name: 'US Dollar', symbol: '$', locale: 'en-US' },
    { code: 'EUR', name: 'Euro', symbol: '€', locale: 'de-DE' },
    { code: 'GBP', name: 'British Pound', symbol: '£', locale: 'en-GB' },
    { code: 'INR', name: 'Indian Rupee', symbol: '₹', locale: 'en-IN' },
    { code: 'JPY', name: 'Japanese Yen', symbol: '¥', locale: 'ja-JP' }
  ];

  const languages = [
    { code: 'en', nativeName: 'English', dir: 'ltr' },
    { code: 'es', nativeName: 'Español', dir: 'ltr' },
    { code: 'fr', nativeName: 'Français', dir: 'ltr' },
    { code: 'ar', nativeName: 'العربية', dir: 'rtl' }
  ];

  const translations = {
    en: {
      home:"Home", calculator:"Calculator", about:"About", contact:"Contact",
      financial_tools:"Financial Tools", loan_calculator:"Loan Calculator",
      hero_title:"Global Loan & EMI Calculator", hero_description:"Plan your finances with our advanced loan calculator. Get accurate monthly payment estimates, interest breakdowns, and amortization schedules for personal, home, car, and education loans in any currency.",
      loan_amount:"Loan Amount", interest_rate:"Interest Rate", loan_term:"Loan Term",
      years:"Years", loan_type:"Loan Type", personal_loan:"Personal Loan", home_loan:"Home Loan",
      car_loan:"Car Loan", education_loan:"Education Loan", business_loan:"Business Loan",
      calculate_emi:"Calculate EMI", reset:"Reset", results:"Loan Calculation Results",
      print_results:"Print", monthly_payment:"Monthly Payment", total_interest:"Total Interest",
      total_payment:"Total Payment", payoff_date:"Payoff Date", loan_breakdown:"Loan Payment Breakdown Chart",
      principal_vs_interest:"(Principal vs Interest)", amortization_schedule:"Amortization Schedule",
      month:"Month", payment:"Payment", principal:"Principal", interest:"Interest", balance:"Balance",
      faq_title:"Frequently Asked Questions", faq1_question:"What is an EMI?", faq1_answer:"EMI stands for Equated Monthly Installment — the fixed monthly payment that covers interest and principal."
    },
    es: {
      hero_title:"Calculadora Global de Préstamos y EMI",
      hero_description:"Planifique sus finanzas con nuestra calculadora avanzada. Obtenga estimaciones de pagos mensuales, desgloses de intereses y calendarios de amortización.",
      calculate_emi:"Calcular EMI", reset:"Reiniciar", monthly_payment:"Pago Mensual", total_interest:"Interés Total",
      total_payment:"Pago Total", faq_title:"Preguntas Frecuentes", faq1_question:"¿Qué es un EMI?", faq1_answer:"EMI significa Cuota Mensual Equivalente: el pago mensual fijo que cubre interés y capital."
    },
    fr: { /* minimal FR translations for demo */ hero_title:"Calculateur Global de Prêt et EMI", calculate_emi:"Calculer EMI", reset:"Réinitialiser" },
    ar: { hero_title:"آلة حاسبة القروض EMI", calculate_emi:"احسب EMI", reset:"إعادة تعيين", faq_title:"الأسئلة الشائعة", faq1_question:"ما هو EMI؟", faq1_answer:"EMI هو القسط الشهري المتساوي الذي يغطي الفائدة والمبلغ الأساسي." }
  };

  // --- DOM references ---
  const loanAmountInput = document.getElementById('loan-amount');
  const loanAmountSlider = document.getElementById('loan-amount-slider');
  const loanAmountValue = document.getElementById('loan-amount-value');
  const loanCurrencySymbol = document.getElementById('loan-currency-symbol');

  const interestRateInput = document.getElementById('interest-rate');
  const interestRateSlider = document.getElementById('interest-rate-slider');
  const interestRateValue = document.getElementById('interest-rate-value');

  const loanTermInput = document.getElementById('loan-term');
  const loanTermSlider = document.getElementById('loan-term-slider');
  const loanTermValue = document.getElementById('loan-term-value');

  const calculateBtn = document.getElementById('calculate-btn');
  const resetBtn = document.getElementById('reset-btn');
  const printBtn = document.getElementById('print-btn');

  const resultsContainer = document.getElementById('results-container');
  const monthlyPaymentEl = document.getElementById('monthly-payment');
  const totalInterestEl = document.getElementById('total-interest');
  const totalPaymentEl = document.getElementById('total-payment');
  const payoffDateEl = document.getElementById('payoff-date');
  const amortizationBody = document.getElementById('amortization-body');

  // language & currency controls
  const languageBtn = document.getElementById('language-btn');
  const languageDropdown = document.getElementById('language-dropdown');
  const currentLanguageEl = document.getElementById('current-language');

  const currencyBtn = document.getElementById('currency-btn');
  const currencyDropdown = document.getElementById('currency-dropdown');
  const currentCurrencyEl = document.getElementById('current-currency');
  const currentCurrencyDisplay = document.getElementById('current-currency-display');

  // defaults
  let currentLanguage = 'en';
  let currentCurrency = 'USD';

  // --- Helpers ---
  function safeTranslation(key) {
    return (translations[currentLanguage] && translations[currentLanguage][key]) || (translations['en'] && translations['en'][key]) || '';
  }

  // populate dropdowns
  function initializeDropdowns(){
    // languages
    languageDropdown.innerHTML = '';
    languages.forEach(lang => {
      const item = document.createElement('div');
      item.className = 'dropdown-item';
      item.setAttribute('data-lang', lang.code);
      item.textContent = lang.nativeName + ' · ' + lang.code;
      languageDropdown.appendChild(item);
    });

    // currencies
    currencyDropdown.innerHTML = '';
    currencies.forEach(c => {
      const item = document.createElement('div');
      item.className = 'dropdown-item';
      item.setAttribute('data-currency', c.code);
      item.textContent = `${c.code} — ${c.name} (${c.symbol})`;
      currencyDropdown.appendChild(item);
    });

    // set UI text
    currentLanguageEl.textContent = languages.find(l=>l.code===currentLanguage).nativeName;
    currentCurrencyEl.textContent = currentCurrency;
    currentCurrencyDisplay.textContent = currentCurrency;
    updateCurrencySymbol();
  }

  function updateCurrencySymbol(){
    const c = currencies.find(x=>x.code===currentCurrency) || currencies[0];
    loanCurrencySymbol.textContent = c.symbol || c.code;
    currentCurrencyEl.textContent = c.code;
    currentCurrencyDisplay.textContent = c.code + ' ' + (c.symbol || '');
  }

  function formatCurrency(value){
    const c = currencies.find(x=>x.code===currentCurrency) || currencies[0];
    try {
      return new Intl.NumberFormat(c.locale || 'en-US', { style: 'currency', currency: c.code, minimumFractionDigits: 2 }).format(value);
    } catch (e) {
      return (c.symbol || c.code) + ' ' + Number(value).toLocaleString();
    }
  }

  // parse flexible numeric strings (commas allowed)
  function parseNumber(v){
    if (v == null) return 0;
    const s = String(v).replace(/,/g,'').trim();
    const n = Number(s);
    return Number.isFinite(n) ? n : 0;
  }

  function updateSliderValues(){
    loanAmountValue.textContent = formatCurrency(parseNumber(loanAmountInput.value || 0));
    interestRateValue.textContent = parseFloat(interestRateInput.value || 0).toFixed(2) + '%';
    loanTermValue.textContent = parseInt(loanTermInput.value || 0) + ' ' + (safeTranslation('years') || 'Years');
  }

  // sync controls
  loanAmountInput.addEventListener('input', () => {
    const n = parseNumber(loanAmountInput.value);
    if (loanAmountSlider) loanAmountSlider.value = Math.max(Number(loanAmountSlider.min), Math.min(Number(loanAmountSlider.max), n || 0));
    updateSliderValues();
  });
  loanAmountSlider.addEventListener('input', () => { loanAmountInput.value = loanAmountSlider.value; updateSliderValues(); });

  interestRateInput.addEventListener('input', () => { if (interestRateSlider) interestRateSlider.value = interestRateInput.value; updateSliderValues(); });
  interestRateSlider.addEventListener('input', () => { interestRateInput.value = interestRateSlider.value; updateSliderValues(); });

  loanTermInput.addEventListener('input', () => { if (loanTermSlider) loanTermSlider.value = loanTermInput.value; updateSliderValues(); });
  loanTermSlider.addEventListener('input', () => { loanTermInput.value = loanTermSlider.value; updateSliderValues(); });

  // calculation
  function calculateEMI(){
    const principal = parseNumber(loanAmountInput.value);
    const annualInterestRate = parseNumber(interestRateInput.value);
    const years = Math.max(1, Math.floor(parseNumber(loanTermInput.value)));

    if (!principal || !years || annualInterestRate < 0) {
      alert('Please enter valid loan amount, interest and term.');
      return;
    }

    const monthlyRate = annualInterestRate / 100 / 12;
    const numberOfPayments = years * 12;
    let emi;
    if (monthlyRate === 0) emi = principal / numberOfPayments;
    else emi = principal * monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments) / (Math.pow(1 + monthlyRate, numberOfPayments) - 1);

    const totalPayment = emi * numberOfPayments;
    const totalInterest = totalPayment - principal;

    // payoff date: end month of payments
    const now = new Date();
    const payoff = new Date(now.getFullYear(), now.getMonth() + numberOfPayments - 1, 1);
    const payoffFormatted = payoff.toLocaleDateString(currentLanguage, { month: 'short', year: 'numeric' });

    monthlyPaymentEl.textContent = formatCurrency(emi);
    totalInterestEl.textContent = formatCurrency(totalInterest);
    totalPaymentEl.textContent = formatCurrency(totalPayment);
    payoffDateEl.textContent = payoffFormatted;

    generateAmortizationSchedule(principal, annualInterestRate, years, emi);

    resultsContainer.classList.add('active');
    resultsContainer.scrollIntoView({ behavior: 'smooth' });
  }

  function generateAmortizationSchedule(principal, annualInterestRate, years, emi){
    const monthlyInterestRate = annualInterestRate / 100 / 12;
    const numberOfPayments = years * 12;
    let balance = principal;
    let rows = '';

    for (let m = 1; m <= numberOfPayments; m++){
      const interestPayment = balance * monthlyInterestRate;
      const principalPayment = Math.min(emi - interestPayment, balance);
      balance = Math.max(0, balance - principalPayment);

      // show first 12 and last 5 as compact
      if (m <= 12 || m > numberOfPayments - 5) {
        rows += `<tr>
          <td>${m}</td>
          <td>${formatCurrency(emi)}</td>
          <td>${formatCurrency(principalPayment)}</td>
          <td>${formatCurrency(interestPayment)}</td>
          <td>${formatCurrency(balance)}</td>
        </tr>`;
        if (m === 12 && numberOfPayments > 17) {
          rows += `<tr><td colspan="5" style="text-align:center;background:#f8f9fa;color:#6c757d;font-style:italic">... ${numberOfPayments - 17} months omitted ...</td></tr>`;
        }
      }
      if (balance <= 0) break;
    }
    amortizationBody.innerHTML = rows;
  }

  // reset
  function resetForm(){
    loanAmountInput.value = '25000'; loanAmountSlider.value = 25000;
    interestRateInput.value = '7.5'; interestRateSlider.value = 7.5;
    loanTermInput.value = '5'; loanTermSlider.value = 5;
    updateSliderValues();
    resultsContainer.classList.remove('active');
    amortizationBody.innerHTML = '';
    monthlyPaymentEl.textContent = formatCurrency(0);
    totalInterestEl.textContent = formatCurrency(0);
    totalPaymentEl.textContent = formatCurrency(0);
    payoffDateEl.textContent = '—';
  }

  // change language: replace text nodes with translations
  function changeLanguage(code){
    currentLanguage = code;
    document.documentElement.lang = code;
    const lang = languages.find(l=>l.code===code);
    document.documentElement.dir = lang && lang.dir ? lang.dir : 'ltr';
    currentLanguageEl.textContent = lang ? lang.nativeName : code;

    // update all translatable text
    document.querySelectorAll('[data-translate]').forEach(el => {
      const key = el.getAttribute('data-translate');
      const txt = safeTranslation(key);
      if (txt) el.textContent = txt;
    });

    // refresh displays/currency formatting
    updateSliderValues();
    if (resultsContainer.classList.contains('active')) calculateEMI();
  }

  // change currency
  function changeCurrency(code){
    currentCurrency = code;
    updateCurrencySymbol();
    updateSliderValues();
    currentCurrencyEl.textContent = code;
    currentCurrencyDisplay.textContent = code;
    if (resultsContainer.classList.contains('active')) calculateEMI();
  }

  // document click handlers for dropdowns and selection
  document.addEventListener('click', (e) => {
    // open/close language dropdown
    if (e.target.closest('#language-btn')) {
      e.stopPropagation();
      languageDropdown.style.display = languageDropdown.style.display === 'block' ? 'none' : 'block';
      return;
    }
    if (e.target.closest('#currency-btn')) {
      e.stopPropagation();
      currencyDropdown.style.display = currencyDropdown.style.display === 'block' ? 'none' : 'block';
      return;
    }

    // language item clicked
    const langItem = e.target.closest('.dropdown-item[data-lang]');
    if (langItem) {
      changeLanguage(langItem.getAttribute('data-lang'));
      languageDropdown.style.display = 'none';
      return;
    }

    // currency item clicked
    const curItem = e.target.closest('.dropdown-item[data-currency]');
    if (curItem) {
      changeCurrency(curItem.getAttribute('data-currency'));
      currencyDropdown.style.display = 'none';
      return;
    }

    // close dropdowns if click outside
    languageDropdown.style.display = 'none';
    currencyDropdown.style.display = 'none';
  });

  // enable clicking on items by setting data attributes when building dropdowns
  function wireDropdownItems(){
    // add data attributes for easier delegation
    languageDropdown.querySelectorAll('.dropdown-item').forEach(item => {
      const code = item.textContent.split('·').pop().trim();
      item.setAttribute('data-lang', code);
    });
    currencyDropdown.querySelectorAll('.dropdown-item').forEach((item, idx) => {
      const c = currencies[idx];
      if (c) item.setAttribute('data-currency', c.code);
    });
  }

  // attach UI events
  calculateBtn.addEventListener('click', (e) => { e.preventDefault(); loanAmountInput.value = String(loanAmountInput.value).replace(/,/g,'').trim(); calculateEMI(); });
  resetBtn.addEventListener('click', (e) => { e.preventDefault(); resetForm(); });
  printBtn.addEventListener('click', (e) => { e.preventDefault(); window.print(); });

  // initialize page
  initializeDropdowns();
  wireDropdownItems();
  updateSliderValues();
  resetForm(); // sets initial displays

  // load AdSense ad units into placeholders if configured
  (function loadAds(){
    const cfg = window.ADSENSE_CONFIG || {};
    if (!cfg.client || !cfg.client.startsWith('ca-pub-')) {
      // show hints in placeholders
      document.getElementById('ad-top-inner').textContent = 'Ad Space — Leaderboard (configure ADSENSE_CONFIG.client)';
      document.getElementById('ad-slot-sidebar-large-inner').textContent = 'Ad Space — 300x600 (configure ADSENSE_CONFIG)';
      document.getElementById('ad-slot-sidebar-small-inner').textContent = 'Ad Space — 300x250 (configure ADSENSE_CONFIG)';
      return;
    }

    // create ins nodes for each slot and request ad render (AdSense must be allowed by account)
    function makeIns(slot) {
      const ins = document.createElement('ins');
      ins.className = 'adsbygoogle';
      ins.style.display = 'block';
      ins.setAttribute('data-ad-client', cfg.client);
      ins.setAttribute('data-ad-slot', slot);
      ins.setAttribute('data-ad-format', 'auto');
      ins.setAttribute('data-full-width-responsive', 'true');
      return ins;
    }

    // inject for each configured slot
    try {
      if (cfg.slots.top) {
        const topInner = document.getElementById('ad-top-inner'); topInner.innerHTML = ''; topInner.appendChild(makeIns(cfg.slots.top));
      }
      if (cfg.slots.sidebar_large) {
        const s = document.getElementById('ad-slot-sidebar-large-inner'); s.innerHTML = ''; s.appendChild(makeIns(cfg.slots.sidebar_large));
      }
      if (cfg.slots.sidebar_small) {
        const s2 = document.getElementById('ad-slot-sidebar-small-inner'); s2.innerHTML = ''; s2.appendChild(makeIns(cfg.slots.sidebar_small));
      }

      window.addEventListener('load', function(){ try { (adsbygoogle = window.adsbygoogle || []).push({}); } catch(e){ console.warn('AdSense push failed', e); }});
    } catch (e){
      console.warn('Ads injection failed', e);
    }
  })();

  </script>
</body>
</html>
